:80 {
    # Auth service routes (strip /auth prefix)
    handle_path /auth/* {
        reverse_proxy auth-service:3001
    }
    
    # API routes to auth service (strip /api prefix)  
    handle_path /api/* {
        reverse_proxy auth-service:3001
    }
    
    # Hello World App routes - strip /hello prefix
    handle_path /hello/* {
        reverse_proxy hello-world-app:3002
    }
    
    # LoL Tracking Service routes - strip /lol prefix
    handle_path /lol/* {
        reverse_proxy lol-tracking-service:3003
    }
    
    # Hearts Game Service routes - strip /hearts prefix with WebSocket support
    handle_path /hearts/* {
        reverse_proxy hearts-game-service:3004 {
            header_up Host {host}
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
            header_up X-Forwarded-Proto {scheme}
        }
    }
    
    # System Monitor routes - preserve /monitor prefix for Grafana sub-path
    handle /monitor/* {
        reverse_proxy grafana:3000
    }
    
    # Main landing page (default catch-all)
    reverse_proxy landing-page:3000
}

kl-pi.tail9f5728.ts.net {
    # Auth service routes (strip /auth prefix)
    handle_path /auth/* {
        reverse_proxy auth-service:3001
    }
    
    # API routes to auth service (strip /api prefix)
    handle_path /api/* {
        reverse_proxy auth-service:3001
    }
    
    # Hello World App routes - strip /hello prefix
    handle_path /hello/* {
        reverse_proxy hello-world-app:3002
    }
    
    # LoL Tracking Service routes - strip /lol prefix
    handle_path /lol/* {
        reverse_proxy lol-tracking-service:3003
    }
    
    # Hearts Game Service routes - strip /hearts prefix with WebSocket support
    handle_path /hearts/* {
        reverse_proxy hearts-game-service:3004 {
            header_up Host {host}
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
            header_up X-Forwarded-Proto {scheme}
        }
    }
    
    # System Monitor routes - preserve /monitor prefix for Grafana sub-path
    handle /monitor/* {
        reverse_proxy grafana:3000
    }
    
    # Main landing page (default catch-all)
    reverse_proxy landing-page:3000
}